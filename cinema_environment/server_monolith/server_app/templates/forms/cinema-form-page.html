<!DOCTYPE html>
{% load static %}
<html>
<head>
	<!-- favicon -->
	<link rel="apple-touch-icon" sizes="57x57" href="favicon/apple-icon-57x57.png">
	<link rel="apple-touch-icon" sizes="60x60" href="favicon/apple-icon-60x60.png">
	<link rel="apple-touch-icon" sizes="72x72" href="favicon/apple-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="76x76" href="favicon/apple-icon-76x76.png">
	<link rel="apple-touch-icon" sizes="114x114" href="favicon/apple-icon-114x114.png">
	<link rel="apple-touch-icon" sizes="120x120" href="favicon/apple-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="144x144" href="favicon/apple-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="152x152" href="favicon/apple-icon-152x152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="favicon/apple-icon-180x180.png">
	<link rel="icon" type="image/png" sizes="192x192"  href="favicon/android-icon-192x192.png">
	<link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="96x96" href="favicon/favicon-96x96.png">
	<link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16x16.png">
	<link rel="manifest" href="favicon/manifest.json">
	<meta name="msapplication-TileColor" content="#ffffff">
	<meta name="msapplication-TileImage" content="favicon/ms-icon-144x144.png">
	<meta name="theme-color" content="#ffffff">
	<title>Cinema</title>
	<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" />

	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==" crossorigin=""/>
	<script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js" integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew==" crossorigin=""></script>
	<!--	<script src="jQuery.SimpleMask.min.js"></script>-->
	<style type="text/css">
		.btn-toolbar{
			margin: 10px;
		}
		.place{
			width: 60px;
		}
		body,html {
			height: 100%;
		}
	</style>
</head>
<body oncontextmenu="return false;">
	<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
		<a class="navbar-brand" href="#">Cinema App</a>
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="navbarSupportedContent">
			<ul class="navbar-nav mr-auto">
				<li class="nav-item active">
					<a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="#">Link</a>
				</li>
				<li class="nav-item dropdown">
					<a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						Dropdown
					</a>
					<div class="dropdown-menu" aria-labelledby="navbarDropdown">
						<a class="dropdown-item" href="#">Action</a>
						<a class="dropdown-item" href="#">Another action</a>
						<div class="dropdown-divider"></div>
						<a class="dropdown-item" href="#">Something else here</a>
					</div>
				</li>
				<li class="nav-item">
					<a class="nav-link disabled" href="#" tabindex="-1" aria-disabled="true">Disabled</a>
				</li>
			</ul>
			<form class="form-inline my-2 my-lg-0">
				<input class="form-control mr-sm-2" type="search" placeholder="Search" aria-label="Search">
				<button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
			</form>
		</div>
	</nav>
	<div class="jumbotron">
		<!-- <form  action="." method="post" enctype="multipart/form-data" > -->
		<form method="POST" enctype="multipart/form-data" id="fileUploadForm">
			{% csrf_token %}
			<!--			{{ form.as_p }}-->
			<div class="container">
				<fieldset class="form-group">
					<div class="row">
						<legend class="col-form-label col-sm-2 pt-0">Name</legend>
						<div class="form-check form-check-inline">
							<input type="text" class="form-control" name="name"  maxlength="256" required="" id="id_name">
						</div>
					</div>
				</fieldset>
				<fieldset class="form-group">
					<div class="row">
						<legend class="col-form-label col-sm-2 pt-0">Address</legend>
						<div class="form-check form-check-inline">
							<textarea name="address" cols="40" rows="10" maxlength="256" required="" id="id_address"></textarea>
						</div>
					</div>
				</fieldset>
				<fieldset class="form-group">
					<div class="row">
						<legend class="col-form-label col-sm-2 pt-0">City</legend>
						<div class="form-check form-check-inline">
							<input type="text" name="city"  maxlength="128" required="" id="id_city" style="display:none" value="1">
							<select class="form-control" id="selectCity">
								<option>Ivano-Frankivsk</option>
								<option>Lviv</option>
								<option>Kiyv</option>
								<option>Kharkiv</option>
								<option>Odessa</option>
							</select>
						</div>
					</div>
				</fieldset>
				<fieldset class="form-group">
					<div class="row">
						<legend class="col-form-label col-sm-2 pt-0">Telephone</legend>
						<div class="form-check form-check-inline">
							<input type="text" class="form-control" name="telephone" maxlength="20" required="" id="id_telephone">
						</div>
					</div>
				</fieldset>
				<div class="form-row">
					<div class="form-group col-md-6">
						<label for="id_geo_lat">Lat</label>
						<input type="number"class="form-control"  name="geo_lat"  step="any" required=""  id="id_geo_lat">
					</div>
					<div class="form-group col-md-6">
						<label for="id_geo_lon">Lon</label>
						<input type="number" class="form-control" name="geo_lon" step="any" required=""  id="id_geo_lon">
					</div>
				</div>
				<fieldset class="form-group">
					<div class="row justify-content-center">
						<div id="mapid" style="width: 1100px; height: 400px;"></div>
					</div>
				</fieldset>
				<fieldset class="form-group">
					<div class="row">
						<legend class="col-form-label col-sm-2 pt-0">Picture</legend>
						<div class="form-check form-check-inline">
							<!-- <input type="file" class="form-control-file" name="pic_url" accept="image/*" required="" id="id_pic_url"> -->
							<input type="file" class="form-control-file" name="pic_url" accept="image/*"  id="id_pic_url">
						</div>
					</div>
				</fieldset>
				<div class="form-group ">
					<!-- <button  class="btn btn-danger" style="margin-top: 10px " onclick="onClearButtonClick()">Clear</button> -->
					<!--				<button  class="btn btn-success" style="margin-top: 10px " onclick="onSubmitButtonClick()">Submit</button>-->
					<!-- <input type="submit" value="Send"  style="margin-top: 10px " > -->
					<!-- <button class="btn btn-success" onclick="onUpdateClick()">Update</button> -->
					<input type="submit" value="Submit" id="btnSubmit"/>
				</div>
			</div>
		</form>
	</div>
	<div class="container ">
		<div class="row">
			<div id="hall-container"  class="col  ">
			</div>
		</div>
	</div>
	<hr>
	<footer>
		<p>&copy; Company 2020</p>
	</footer>
</div> 
<script type="text/javascript">


	$(document).ready(function () {

    $("#btnSubmit").click(function (event) {

        //stop submit the form, we will post it manually.
        event.preventDefault();

        // Get form
        var form = $('#fileUploadForm')[0];

		// Create an FormData object 
        var data = new FormData(form);

		// If you want to add an extra field for the FormData
        data.append("CustomField", "This is some extra data, testing");

		// disabled the submit button
        $("#btnSubmit").prop("disabled", true);

        $.ajax({
            type: "POST",
            enctype: 'multipart/form-data',
            url: "http://127.0.0.1:8000/admin/server_app/cinema/50/change/",
            data: data,
            processData: false,
            contentType: false,
            cache: false,
            timeout: 600000,
            success: function (data) {

                $("#result").text(data);
                console.log("SUCCESS : ", data);
                $("#btnSubmit").prop("disabled", false);

            },
            error: function (e) {

                $("#result").text(e.responseText);
                console.log("ERROR : ", e);
                $("#btnSubmit").prop("disabled", false);

            }
        });

    });

});

	
	
	function onSubmitButtonClick() {
		
		

	}

	function onClearButtonClick(){
		

	}


	function onUpdateClick() {


		// var temp = 50
		// $.ajax({
		// 	url: 'http://127.0.0.1:8000/admin/server_app/ticket/60/change/',
		// 	type: 'POST',
		// 	success: function(result) {
		// 		location.reload();
		// 	},
		// 	data:{
		// 		csrfmiddlewaretoken: '{{ csrf_token }}',
		// 		place:"l-1-1",
		// 		code:"000",
		// 		status:"1",
		// 		user:"3",
		// 		timeline_id:"12",
		// 		_save:"Save"

		// 	}
		// });


			var temp = 50
		$.ajax({
			url: 'http://127.0.0.1:8000/admin/server_app/cinema/50/change/',
			type: 'POST',
			success: function(result) {
				// location.reload();
				alert(result)
			},
			data:{
				csrfmiddlewaretoken: '{{ csrf_token }}',
				place:"l-1-1",
				code:"000",
				status:"1",
				user:"3",
				timeline_id:"12",
				_save:"Save"

			}
		});




	}

	

	$(document).ready
	(
		function()
		{

			// $('#inputTelephone' ).simpleMask( { 'mask': '+## ### ### ####'                          , 'nextInput': $('#inputTelephone') } );

			// $('#frCallback').simpleMask
			// (
			// {
			// 	'mask'       : '#####',
			// 	'nextInput'  : true,
			// 	'onComplete' : function(element)
			// 	{
			// 		console.log('onComplete', element);
			// 	}
			// }
			// );
			


			$("#selectCity").change(function(){

				var selected = $(this).children("option:selected").val();

				console.log(selected)

				switch(selected){
					case 'Ivano-Frankivsk':
					$("#id_city").val('1')
					mymap.setView([48.92251336314805,24.71046209335327],13)
					break
					case 'Lviv':
					$("#id_city").val('2')
					mymap.setView([49.84188493635143,24.03167009353638],13)
					break
					case 'Kiyv':
					$("#id_city").val('3')
					mymap.setView([50.44953213509495,30.52538394927979],13)
					break
					case 'Kharkiv':
					$("#id_city").val('4')
					mymap.setView([49.989256184848294,36.23102188110352],13)
					break
					case 'Odessa':
					$("#id_city").val('5')
					mymap.setView([46.483959151247554,30.73260068893433],13)
					break
				}

			});
		}
		);




	var mymap = L.map('mapid').setView([48.9315044382551, 24.697823524475098], 15);
	// set on-air coords.
	// mymap.setView([50.44727079882932,30.523656606674198],15)

	L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
		maxZoom: 18,
		attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
		'<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
		'Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
		id: 'mapbox/streets-v11'
	}).addTo(mymap);


	var popup = L.popup();

	function onMapClick(e) {
		popup
		.setLatLng(e.latlng)
		.setContent($('#id_name').val()==''?'Your cinema':$('#id_name').val())
		.openOn(mymap);
		console.log(e.latlng.lat)
		console.log(e.latlng.lng)
		$('#id_geo_lat').val(e.latlng.lat)
		$('#id_geo_lon').val(e.latlng.lng)

	}

	mymap.on('click', onMapClick);


</script>
</body>
</html>